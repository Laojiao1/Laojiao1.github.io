<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>【深度学习】多目标追踪——匈牙利算法与KM算法</title>
    <link href="/2025/01/10/Hungarian/"/>
    <url>/2025/01/10/Hungarian/</url>
    
    <content type="html"><![CDATA[<h1>多目标追踪——匈牙利算法与KM算法</h1><h2 id="一、基本概念">一、基本概念</h2><ul><li><strong>匈牙利算法</strong>（Hungarian Algorithm）是一种用于解决 <strong>二分图最大匹配</strong> 或 <strong>最小权重匹配</strong> 问题的算法，常用于优化分配问题。该算法的核心目标是通过优化一个矩阵的方式，找到最优的匹配方案，最常见的应用是任务分配问题，比如将n个任务分配给n个人，使得任务的总成本最小或总效益最大。</li><li>此算法之所以被称作匈牙利算法，是因为算法很大一部分是基于以前匈牙利数学家 Dénes Kőnig 和 Jenő Egerváry 的工作之上创建起来的。</li><li>匈牙利算法有很多的用途，但在本文中，我们主要讨论匈牙利算法在目标追踪中的作用。</li></ul><ol><li><p><strong>二分图</strong></p><ul><li><p>二分图是一种特殊的图，它的节点可以分成两个互不重叠的集合，使得图中每条边都连接这两个集合中的节点。换句话说，二分图的所有边都跨越这两个集合，图中的每一条边都连接一个集合中的节点与另一个集合中的节点。</p><p>以下是一个典型的二分图</p></li></ul><p><img src="/img/Hungarian/bcad61ec6ee23b6fd1175da36b086bc.png" alt="图1"></p></li><li><p>匹配</p><ul><li><strong>匹配（Matching）</strong> 是图论中的一个基本概念，指的是在图中选择一组边，使得每条边的两个端点都不相同（即不重复）。具体来说，匹配问题要求选择一些边，使得这些边没有共享的顶点。</li></ul><p><img src="/img/Hungarian/image-20250110171824278.png" alt="图2"></p><ul><li>如果存在一组边，使得图中的大部分节点都与其他节点有匹配关系（而不是全部），称为 <strong>近似匹配（Near Perfect Matching）</strong> 或 <strong>最大匹配（Maximum Matching）</strong>。</li></ul></li></ol><p>因此，匈牙利算法适用于求解 <strong>二分图的最大匹配</strong> 或 <strong>最小权重匹配</strong> 问题，时间复杂度通常为O (n3)</p><h2 id="二、匈牙利算法">二、匈牙利算法</h2><h3 id="为什么需要匈牙利算法？">为什么需要匈牙利算法？</h3><p>在目标跟踪中，随着时间的推移，物体的位置会不断变化，特别是在动态环境下，物体可能会发生遮挡、交叉、或快速移动。因此，我们不仅需要对物体进行准确的检测，还需要在不同的帧之间保持对同一物体的追踪，以确保物体在整个视频序列中始终保持相同的ID。这是目标跟踪中的 <strong>数据关联问题</strong>，也就是在每一帧中，如何将当前帧检测到的目标与上一帧的目标进行匹配，保持物体的身份一致性。</p><p>为了实现这一点，我们通常使用 <strong>匈牙利算法</strong> 来解决这个匹配问题。</p><h3 id="Example">Example</h3><p>我们来用一个实际的例子说明匈牙利算法的步骤：</p><p>以下图为例，假设左边的四张图是我们在第N帧检测到的目标（U），右边四张图是我们在第N+1帧检测到的目标（V）。红线连起来的图，是我们的算法认为是同一行人可能性较大的目标。但由于算法并不是绝对理想的，因此并不一定会保证每张图都有一对一的匹配，可能每张图有一对二甚至一对多的情况发生。</p><p><img src="/img/Hungarian/image-20200227185052525.png" alt="图3"></p><ul><li><p>第一步</p><p>给图片1进行匹配，发现此时与其相连的右1还未匹配，于是将其配对，连上一条蓝线。</p></li></ul><p><img src="/img/Hungarian/image-20200227185149106.png" alt="图4"></p><ul><li><p>第二步</p><p>接着匹配左2，发现此时与其相连的右二还未匹配，于是将其配对，连上一条蓝线。</p></li></ul><p><img src="/img/Hungarian/image-20200227185228250.png" alt="图5"></p><ul><li><p>第三步</p><p>接着匹配 左3 ，我们发现，左3 与其相连接的 右1 和 右2 都已经预先被匹配完毕了。</p><p>但为了完成 左3 的匹配任务，我们想到可以给之前 右1 的匹配的对象—— 左1，重新分配一个新的对象 ——即与 左1 相连的另一张图 右2。</p><p>但我们又发现，右2 也已经被匹配出去了。</p><p>于是我们可以用同样的思想，给之前 右2 匹配的对象—— 左2，重新分配一张图——即与左2相连的另一张图 右3。（后面再遇到类似的情况也是同样的操作，这是一个递归的过程）</p><p>此时的匹配结果分别如下：（黄色的线表示临时被拆除的线）</p><p><img src="/img/Hungarian/image-20250110174112528.png" alt="图6"></p><p>这时，问题就迎刃而解了，左3完美匹配上了右1！</p><p><img src="/img/Hungarian/image-20200227185430170.png" alt="图7"></p></li><li><p>第四步：</p><p>最后匹配左4，很遗憾，按照第三步无法给左4腾出来一个匹配对象，无奈放弃。匈牙利算法至此结束。</p></li></ul><p>可以看到，由于在候选匹配中包含了许多错误的匹配红线，所以按照算法流程下来匹配准确率并不高。可见匈牙利算法预先红线连接的准确率依赖度较高，也就是说要求我们事先必须要进行一个精准的预测，比如设定一个阈值（置信度），把较高置信度的边送入匈牙利算法进行匹配，才能够得到更好的结果。</p><p><strong>为了更好的解决上述问题，我们可以采取KM算法</strong></p><h2 id="三、KM算法">三、KM算法</h2><p>KM算法的应用背景可以是一个 <strong>带权二分图</strong>，其中每一条边都有一个代价。目标是找到一个最优匹配，使得所选边的总代价最小。</p><h3 id="算法步骤">算法步骤</h3><ol><li><p>首先对每个顶点赋值，将左边的顶点赋值为最大权重，右边的顶点赋值为0。</p><p>如图，我们将左1赋值为其两边中较大的0.8。</p><p><img src="/img/Hungarian/image-20200227185713197.png" alt="图8"></p></li><li><p>进行匹配。</p><p>匹配的原则是：<strong>只与权重相同的边进行匹配</strong>。</p><p>若找不到匹配的边，则对此条路径的所有左图权重-0.1，右图权重+0.1。（加减的值不唯一，视情况而定）</p><p>例如对左1进行匹配，符合匹配条件的只有：左1 —— 右1</p><p><img src="/img/Hungarian/image-20200227185802547.png" alt="图9"></p><p>同理：接下来对左2进行匹配。</p><p><img src="/img/Hungarian/image-20200227185829028.png" alt="图10"></p><p>然后是左3，注意此时左3想匹配的对象（右1）已经被左1匹配了，而左1又无法重新匹配一个新的对象（因为开始匹配的边权最大）。那应该怎么办呢？</p><p>我们不妨可以用给员工分配工作的角度思考：其实我们寻找<strong>最优匹配</strong>的过程，也就是<strong>帮每个员工找到他们工作效率最高的工作</strong>，但有些工作会冲突，员工A和员工B对工作C的工作效率都是最高的，这是我们应该让A或者B换一份工作，但如果真这么做了，那么我们只能换到<strong>降低总体效率值的工作</strong>。</p><p>但我们现在只要求最优匹配，所以<strong>如果员工A换一份工作效率稍微低一些的工作的话，我们是可以接受的（对员工B也是如此）</strong></p><p><img src="/img/Hungarian/image-20250110185620992.png" alt="图11"></p><p>那么在KM算法中的体现就是：<strong>对所有冲突的边的顶点做加减操作</strong>，令左边顶点值减0.1，右边顶点值加0.1。结果如下图所示。</p><p><img src="/img/Hungarian/image-20200227185854835.png" alt="图12"></p><p>经过此操作后，再重新进行匹配操作。</p><p>恭喜！左3多了一条可匹配的边，因为此时左3对右2的匹配要求只需权重大于等于0.8+0即可，所以左3与右2匹配成功！</p><p><img src="/img/Hungarian/image-20200227185923170.png" alt="图13"></p><p>最后进行左4的匹配。由于左4唯一的匹配对象右3已被左2匹配，发生冲突。进行一轮加减操作重新匹配后发现左四还是匹配失败。再经过两轮以后左4期望值降为0，放弃匹配。</p><p>至此KM算法结束。成功匹配三对，可以发现采用KM算法的匹配结果比之前采用匈牙利算法匹配的结果更加精准可靠。</p></li></ol><h2 id="四、代码实现">四、代码实现</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 将yolo模型的检测框和卡尔曼滤波的跟踪框进行匹配</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">associate_detections_to_trackers</span>(<span class="hljs-params">detections, trackers, iou_threshold = <span class="hljs-number">0.3</span></span>):<br>    <span class="hljs-comment"># 检测框数</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(trackers) == <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">return</span> np.empty((<span class="hljs-number">0</span>, <span class="hljs-number">2</span>), dtype = <span class="hljs-built_in">int</span>), np.arange(<span class="hljs-built_in">len</span>(detections)), np.empty((<span class="hljs-number">0</span>, <span class="hljs-number">5</span>), dtype = <span class="hljs-built_in">int</span>)<br>    <span class="hljs-comment"># 跟踪框数</span><br>    iou_matrix = np.zeros((<span class="hljs-built_in">len</span>(detections), <span class="hljs-built_in">len</span>(trackers)), dtype = np.float32)<br>    <span class="hljs-comment"># 计算检测框和跟踪框之间的IOU</span><br>    <span class="hljs-keyword">for</span> d, det <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(detections):<br>        <span class="hljs-keyword">for</span> t, trk <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(trackers):<br>            iou_matrix[d, t] = IOU(det, trk)<br>    <span class="hljs-comment"># 匈牙利算法进行匹配</span><br>    matched_indices = linear_sum_assignment(-iou_matrix)<br>    <span class="hljs-comment"># 未匹配的检测框</span><br>    unmatched_detections = []<br>    <span class="hljs-keyword">for</span> d, det <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(detections):<br>        <span class="hljs-keyword">if</span> d <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> matched_indices[<span class="hljs-number">0</span>]:<br>            unmatched_detections.append(d)<br>    <span class="hljs-comment"># 未匹配的跟踪框</span><br>    unmatched_trackers = []<br>    <span class="hljs-keyword">for</span> t, trk <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(trackers):<br>        <span class="hljs-keyword">if</span> t <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> matched_indices[<span class="hljs-number">1</span>]:<br>            unmatched_trackers.append(t)<br>    <span class="hljs-comment"># 未匹配的跟踪框</span><br>    matches = []<br>    <span class="hljs-keyword">for</span> d, t <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(matched_indices[<span class="hljs-number">0</span>], matched_indices[<span class="hljs-number">1</span>]):<br>        <span class="hljs-keyword">if</span> iou_matrix[d, t] &lt; iou_threshold:<br>            unmatched_detections.append(d)<br>            unmatched_trackers.append(t)<br>        <span class="hljs-keyword">else</span>:<br>            matches.append((d, t))<br>    <span class="hljs-comment"># 返回匹配结果</span><br>    <span class="hljs-keyword">return</span> np.array(matches), np.array(unmatched_detections), np.array(unmatched_trackers)<br></code></pre></td></tr></table></figure><h2 id="参考文献">参考文献</h2><ul><li><a href="https://www.cnblogs.com/ariel-dreamland/p/13522590.html">https://www.cnblogs.com/ariel-dreamland/p/13522590.html</a></li><li><a href="https://zhuanlan.zhihu.com/p/459758723">https://zhuanlan.zhihu.com/p/459758723</a></li><li><a href="https://zhuanlan.zhihu.com/p/62981901">https://zhuanlan.zhihu.com/p/62981901</a></li><li><a href="https://blog.csdn.net/lemonxiaoxiao/article/details/108704280">https://blog.csdn.net/lemonxiaoxiao/article/details/108704280</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>DeepLearning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>DeepLearning</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【SEO方向】Google抓取网页流程和搜索算法</title>
    <link href="/2025/01/09/GoogleSearch/"/>
    <url>/2025/01/09/GoogleSearch/</url>
    
    <content type="html"><![CDATA[<h1>2. Google抓取网页流程和搜索算法</h1><h2 id="一、Google-搜索的基本流程">一、Google 搜索的基本流程</h2><p>从视频中可以看到Google抓取和输出一个网页在搜索结果的流程大概是：</p><ol><li>用户在 Google 搜索框中输入关键词或查询短语，发起搜索请求。</li><li>Google 的搜索引擎蜘蛛（Googlebot）会遍历互联网上的网页，收集它们的内容（<strong>抓取</strong>）并加入到Google的索引库中（<strong>索引</strong>）。</li><li>当用户发起查询时，Google 会根据多个排名因素（如页面内容、关键词相关性、网站质量等）对索引中的网页进行排序。Google 会使用算法评估哪个页面最符合用户查询的需求，在自己的索引库中找到合适的网页展示给用户</li></ol><p><img src="/img/SEO/image-20250109203925071.png" alt=""></p><p>想要Google发现你的网站并且加入索引，我们可以通过：</p><ul><li><p>提交<strong>站点地图（Sitemap）</strong>—— 一个包含你网站所有重要页面的文件，可以帮助搜索引擎更容易地发现并抓取你的内容。</p></li><li><p>通过 <strong>Google Search Console</strong> 提交网站地图 —— 确保 Googlebot 能更快地抓取和索引你的页面。</p></li></ul><p>以上两种方式来告诉Google你的网站链接。</p><p>Google为你网页计算内容排名的时候，就会考虑你页面的标题、描述、url或者内容等地方是否会出现对应的关键词，或者关键词的近义词。</p><p><img src="/img/SEO/image-20250109204435550.png" alt=""></p><h2 id="二、Google搜索排名算法">二、Google搜索排名算法</h2><p>假如你的网站允许被Google抓取，那么Google机器人就会把你的网站内容收录到索引库中，但索引库中必然会有千亿级别的网页。Google搜索排名算法就是对这些索引进行整理和排序，以最快的速度把用户所需要的内容呈现出来。</p><p><strong>Google的排名系统由多个算法共同运作，而不是单一的算法。为了提供最相关的信息，Google的搜索算法会综合考虑多种因素，包括查询的关键词、网页的相关性和可用性、信息来源的权威性，以及用户的位置和个人设置。每个因素的权重会根据查询的不同而有所变化。例如，对于查询字典定义类的信息，网页的相关性更为重要；而在查询时事新闻时，内容的新鲜度则会被赋予更高的权重。</strong></p><h3 id="1-分析关键词">1. 分析关键词</h3><p>Google有一套完整的语言模型，会根据你输入的关键词进行一系列的分析。</p><p>例如：</p><ul><li>搜索“如何换灯泡” —— 这里“换”的意思是“替换”</li><li>搜索“如何换货币” —— 这里“换”的意思是“兑换”</li></ul><h3 id="2-挑选与搜索内容相符合的页面">2. 挑选与搜索内容相符合的页面</h3><p>当Google了解你的搜索意图后，Google会从自己的索引库中寻找与查询信息相匹配的网页。</p><p><img src="/img/SEO/image-20250109205828224.png" alt=""></p><p>也就是说，在搜索时，Google算法会在索引中查询您的搜索关键词以找到合适的网页，算法分析的内容包括但不限于在某个网页上的<strong>关键字或者相关信息</strong>的<strong>出现频率</strong>。</p><p><strong>这也给我们在做SEO时提供了启发</strong>——想要获得某个关键词的排名，那么你的文章标题和内容应该包含一定的关键词，帮助Google算法了解你的网页内容从而推荐给相关用户。但是一定不能为了排名而乱插入关键词。</p><h3 id="3-为网页排名">3. 为网页排名</h3><p><img src="/img/SEO/image-20250109205808224.png" alt=""></p><p>网页排名是搜索引擎根据一系列因素决定特定网页在搜索结果中显示位置的过程。Google 的排名系统基于复杂的算法，通过评估网页的相关性、质量、权威性等来确定排名。</p><p>这个排名过程中，会根据用户在网页的停留时间，PageRank，或者内链接等因素多方面考虑。因此网页的排名是在不断变化当中的。</p><p>Google 对站长提出了基本要求：</p><ul><li>在设计网站时，应该首先关注用户的需求，而不是单纯为了迎合搜索引擎。</li><li>避免做出任何欺骗用户的行为。</li><li>不要采用不正当手段来提升搜索引擎排名。衡量自己做法是否合适的一种方式是，想象自己需要向竞争对手或 Google 的员工解释这些做法时，是否能心安理得。另一个自我测试的方法是，问自己：“这是否能真正为用户提供价值？如果没有搜索引擎的存在，我是否还会这么做？”</li><li>思考怎样才能让自己的网站在行业中独树一帜，具有独特性、价值或者吸引力，从而在同类网站中脱颖而出。</li></ul><h3 id="4-返回最佳结果">4. 返回最佳结果</h3><p>在第三步为网页排名中，Google对索引库的页面有一个基础排名后，并不一定在实际显示出来的结果排名中就一定位于第一名。真正的第一名，Google还会根据一些其他因素来考虑。</p><p><img src="/img/SEO/image-20250109210121782.png" alt=""></p><p>假设用户搜索“如何选择适合的跑步鞋”。</p><p>Google会首先根据关键词匹配和页面相关性对多个网页进行基础排名。然而，如果其中一篇文章刚刚更新，包含了2025年最新款的跑步鞋推荐，而另一篇文章发布于几个月前没有最新信息，那么即使后者在基础排名中较高，Google可能会优先显示更新的页面，因为它提供了更具时效性的内容。</p><p>此外，页面的加载速度和移动端体验也会影响最终排名，哪怕基础排名较低的页面提供了更好的用户体验，Google也可能将其排在前面。</p><h3 id="5-搜索环境和地理位置">5. 搜索环境和地理位置</h3><p>Google 在搜索结果排序时，会根据你的地理位置和个人搜索历史来调整显示内容。</p><p>这意味着，不同国家和地区的用户搜索相同的关键词时，得到的搜索结果可能会有所不同。</p><p><img src="/img/SEO/image-20250109210508669.png" alt=""></p><p>例如，假设你搜索“最佳餐厅”。如果你位于纽约，Google会优先显示你所在城市的餐厅推荐，而不是全球或其他城市的餐厅。即使其他地方的餐厅排名很高，Google会根据你的位置提供更相关的本地搜索结果。此外，如果你过去经常搜索过某些餐厅或餐饮相关的内容，Google可能会根据你的搜索历史推荐你可能感兴趣的餐厅，进一步个性化你的搜索结果。</p><h2 id="参考文献">参考文献</h2><ul><li><a href="https://www.google.com/intl/zh-CN/search/howsearchworks/crawling-indexing/">https://www.google.com/intl/zh-CN/search/howsearchworks/crawling-indexing/</a></li><li><a href="https://www.google.com/intl/zh-CN/search/howsearchworks/algorithms/">https://www.google.com/intl/zh-CN/search/howsearchworks/algorithms/</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>SEO</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SEO</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【小白笔记】Google SEO 初探</title>
    <link href="/2025/01/09/SeoExplore/"/>
    <url>/2025/01/09/SeoExplore/</url>
    
    <content type="html"><![CDATA[<h1>1. Google SEO——从搜索引擎优化中获得更多免费流量</h1><h2 id="一、什么是Google-SEO？">一、什么是Google SEO？</h2><p>SEO是搜索引擎优化的缩写，Google SEO就是针对Google的搜索引擎优化。</p><p>是在符合Google优化规则的前提下对网站进行一系列的设置和优化，让网站获得更好的搜索排名，从而获得更多的免费流量。</p><h2 id="二、为什么SEO很重要？">二、为什么SEO很重要？</h2><p>每天都有很多人通过Google搜索找到自己需要的东西，而我们做SEO优化就是为了获得更好的搜索排名，从而让更多潜在用户访问你的网站，进而产生成交，带来收益。</p><h2 id="三、如何做SEO？">三、如何做SEO？</h2><p>Google的建议是你应该搭建一个对用户有用的网站，任何优化都是用于改善用户体验。简单理解就是以用户体验为首位，发布有价值的文章内容，文章的标题和内容部分包含有意义的搜索关键词。</p><p>PS：<a href="https://www.by928.com/guizhou/502.html">外贸网站SEO不是给钱就能成的</a></p><h3 id="第一步：关键词研究">第一步：关键词研究</h3><p><strong>关键词</strong>，英文名叫<strong>Keywords</strong>，简单来说就是你这个网站希望别人通过什么词语搜索到你。</p><p>选取关键词是第一步也是最重要的一步。如果选错了关键词，那么在整个SEO过程中都会走很多的弯路。假如最开始的定位并非做现在的内容，就会导致定位更换几次，如果关键词没定好，内容规划起来就很麻烦。</p><p>很多外贸网站在设置标题时，仅仅使用公司名称，或者干脆不设置标题，这样做不利于SEO优化。除非你是全球知名品牌，否则很少有人会通过你的品牌名来寻找你的网站。为了提升曝光率和流量，你的标题应该<strong>包含与你的产品和服务相关的关键词</strong>。比如，你可以将标题设置为：“XXX – 手机配件批发, 手机壳, 数据线, 手机充电器制造商”。这样，潜在客户在搜索“手机配件”、“手机壳”、“数据线”或“手机充电器制造商”等相关关键词时，就有更高的机会找到你的网站，提升网站的可见性和搜索排名。</p><h3 id="第二步：编写友好内容">第二步：编写友好内容</h3><p>简单来说就是站在用户的角度来写文章，确保内容不仅对搜索引擎有利，更能解决用户的实际问题，提升用户体验。</p><p>例如，香水网站在编写文章时，想着的就是提供香水选购的全面指南，同时也有人搜索“男士香水推荐”、“女士香水品牌”、“香水购买指南”等词汇，因此你看到的这个页面标题叫“香水购买指南_ 男士香水推荐 _女士香水品牌推荐 | 香水之家”。</p><p>满足SEO基本要求：</p><ol><li>内容满足用户需要</li><li>内容有价值</li></ol><p>内容优化还有很多细节要做，例如标题标签优化，Meta描述优化，URL优化，内容优化，内部链接，移动端优化等等可以操作的地方。</p><h3 id="第三步：内部链接优化">第三步：内部链接优化</h3><p><img src="/img/SEO/%E5%86%85%E9%93%BE%E5%9B%BE.png" alt="内链"></p><p>如上图，把网站的文章页面串联起来。</p><p>简单来说，就是那些在文本里可以点击的链接，点进去同样是该网站下的文章或者页面，这就是内链。</p><p>内链建设时要保证顺其自然，不要刻意添加，否则会导致网页结构紊乱，劝退用户的阅读意愿。应该是文章写到那个地方，在合适的地方添加一个对用户有帮助的链接。</p><h3 id="第四步：外部链接建设">第四步：外部链接建设</h3><p>SEO界有一句俗话——“内容为王，外链为皇”，所谓外部链接就是其他网站指向你网站的链接。</p><p>作为商业网站，外联是提高网站可信度和排名的关键因素。</p><p>具体来说有以下几种方式（其实就是蹭流量）：</p><ul><li><p><strong>获得高质量的外部链接</strong>：从相关领域的网站或博客获取高质量的反向链接。</p></li><li><p><strong>客座博客</strong>：写一些与自己业务相关的文章，发布在其他高流量网站或博客上，获得链接。</p></li><li><p><strong>社交媒体</strong>：通过社交媒体渠道吸引流量，提升品牌曝光，并间接影响SEO。</p></li></ul><p>但有一点一定要注意：<strong>不要花钱买低质量外链！</strong></p><h2 id="四、Google-SEO优化工具">四、Google SEO优化工具</h2><p>一些很好用的工具可以来帮助我们更加高效的进行SEO工作，提升可行度。</p><h4 id="Google-Search-Console"><a href="https://developers.google.cn/search/docs/monitor-debug/search-console-start?hl=zh-cn">Google Search Console</a></h4><p>Google Search Console又称谷歌搜索控制台、谷歌管理员工具、谷歌站长工具，是Google官方推出的站点管理工具，<strong>如果Google的搜索蜘蛛发现你网站有任何问题了，就会通知你</strong>。你也可以在上面看到很多网站在Google上面的数据。</p><h4 id="Google-Analytics"><a href="https://developers.google.cn/analytics?hl=zh-cn">Google Analytics</a></h4><p><strong>Google Analytics</strong> 是一款由 Google 提供的免费网页分析工具，<strong>添加到网站后可以告诉你网站每天的流量信息</strong>。</p><p><strong>主要功能：</strong></p><ol><li><strong>访问量分析</strong>：查看网站的访问次数、页面浏览量、访客来源等。</li><li><strong>用户行为追踪</strong>：分析用户在网站上的行为，如浏览的页面、停留时间、跳出率等。</li><li><strong>流量来源</strong>：分析访客是通过搜索引擎、社交媒体、广告还是直接访问来到网站。</li><li><strong>受众分析</strong>：查看访客的地理位置、设备、浏览器等信息，帮助你优化用户体验。</li></ol><p>这些数据可以用来分析网站的用户访问情况，然后进行对应的SEO调整，是很重要的一项工作。</p><p>当然，SEO工具只是辅助，关键还是网站内容和基础的SEO优化。</p>]]></content>
    
    
    <categories>
      
      <category>SEO</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SEO</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【深度学习】目标追踪检测——卡尔曼滤波</title>
    <link href="/2025/01/09/kalman/"/>
    <url>/2025/01/09/kalman/</url>
    
    <content type="html"><![CDATA[<h1>卡尔曼滤波——目标追踪检测</h1><p>最近在做毕设时涉及了卡尔曼滤波的学习，以此篇文章来记录我的探索之旅。</p><h2 id="一、背景介绍">一、背景介绍</h2><p>卡尔曼滤波（Kalman）是一种在单目标和多目标检测领域中的常用算法，卡尔曼滤波可以看做一种<strong>运动模型</strong>，用来对目标的位置进行预测，并且利用<strong>预测结果对跟踪的目标进行修正</strong>。它能在存在诸多不确定性情况的组合信息中<strong>估计动态系统的状态</strong>，是一种强大的、通用性极强的工具。</p><p>只要是存在不确定信息的动态系统，卡尔曼滤波(Kalman)就可以对系统下一步要做什么做出有根据的推测。即使有噪声信息干扰，卡尔曼滤波通常也能很好的弄清楚究竟发生了什么，找出现象间不易察觉的相关性。因此卡尔曼滤波(Kalman)非常适合不断变化的系统。</p><p>它的优点还有内存占用较小（只需保留前一个状态）、速度快，是实时问题和嵌入式系统的理想选择。</p><h2 id="二、卡尔曼滤波的原理">二、卡尔曼滤波的原理</h2><p>目标的位置，速度，加速度的测量值往往在任何时候都有噪声。卡尔曼滤波利用目标的动态信息，设法去掉噪声的影响，得到一个关于目标位置的好的估计。这个估计可以实对<strong>当前目标位置</strong>的估计，也可以是对<strong>将来位置</strong>的估计，同时也可以是<strong>对过去位置</strong>的估计。</p><ul><li><strong>场景描述</strong></li></ul><p>我们假设一个简单的场景，有一辆小车在行驶，它的速度是v，可以通过观测得到它的位置p,也就是说我们可以实时的观测小车的状态。</p><p>假设小车在某一时刻的状态可以表示为如下向量：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mover accent="true"><mi>x</mi><mo>⃗</mo></mover><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>p</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>v</mi></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\vec{x} =  \begin{bmatrix} p \\ v \\ \end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.714em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2077em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewBox="0 0 471 714" preserveAspectRatio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 53.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 1110.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359c-16-25.333-24-45-24-59z"/></svg></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span></p><p>虽然我们比较确定小车此时的状态，无论是计算还是检测都会存在一定的误差，所以我们只能认为当前状态是其真实状态的一个<strong>最优估计</strong>。那么我们不妨认为当前状态服从一个高斯分布，如下图所示：</p><p><img src="/img/kalman/image-20250109112459878.png" alt="图1"></p><p>高斯分布的中心 <code>μ</code> 就是图中的 X<sub>k</sub></p><ul><li><p><strong>预测下一时刻的状态</strong></p><p>通过一些物理学知识来预测小车的下一个状态，即通过k-1时刻的位置和速度，可以推测下一个时刻的状态为：</p></li></ul><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>p</mi><mi>k</mi></msub><mo>=</mo><msub><mi>p</mi><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>v</mi><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">Δ</mi><mi>t</mi><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi>a</mi><mi mathvariant="normal">Δ</mi><msup><mi>t</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">p_k = p_{k-1} + v_{k-1}Δt + \frac{1}{2}aΔt^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mord">Δ</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.0074em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal">a</span><span class="mord">Δ</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>v</mi><mi>k</mi></msub><mo>=</mo><msub><mi>v</mi><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>a</mi><mi mathvariant="normal">Δ</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">v_k = v_{k-1} + aΔt</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">a</span><span class="mord">Δ</span><span class="mord mathnormal">t</span></span></span></span></span></p><p>​写成矩阵的形式：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mover accent="true"><mi mathvariant="bold">x</mi><mo>^</mo></mover><mi>k</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi mathvariant="normal">Δ</mi><mi>t</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><msub><mover accent="true"><mi mathvariant="bold">x</mi><mo>^</mo></mover><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mfrac><mrow><mi mathvariant="normal">Δ</mi><msup><mi>t</mi><mn>2</mn></msup></mrow><mn>2</mn></mfrac></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi mathvariant="normal">Δ</mi><mi>t</mi></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mi>a</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi mathvariant="bold">F</mi><mi>k</mi></msub><msub><mover accent="true"><mi mathvariant="bold">x</mi><mo>^</mo></mover><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi mathvariant="bold">B</mi><mi>k</mi></msub><msub><mi mathvariant="bold">u</mi><mi>k</mi></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}\hat{\mathbf{x}}_{k} &amp; =\begin{bmatrix}  1 &amp; Δt\\  0 &amp; 1\end{bmatrix} \hat{\mathbf{x}}_{k-1}+\left[\begin{array}{c}\frac{\Delta t^{2}}{2} \\\Delta t\end{array}\right] a \\&amp; =\mathbf{F}_{k} \hat{\mathbf{x}}_{k-1}+\mathbf{B}_{k} \mathbf{u}_{k}\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.3779em;vertical-align:-1.939em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.439em;"><span style="top:-4.439em;"><span class="pstrut" style="height:3.539em;"></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7079em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathbf">x</span></span><span style="top:-3.0134em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.26em;"><span class="pstrut" style="height:3.539em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.939em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.439em;"><span style="top:-4.439em;"><span class="pstrut" style="height:3.539em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">Δ</span><span class="mord mathnormal">t</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7079em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathbf">x</span></span><span style="top:-3.0134em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.539em;"><span style="top:-3.539em;"><span class="pstrut" style="height:3.0179em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0179em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">Δ</span><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-2.339em;"><span class="pstrut" style="height:3.0179em;"></span><span class="mord"><span class="mord">Δ</span><span class="mord mathnormal">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.039em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">a</span></span></span><span style="top:-2.26em;"><span class="pstrut" style="height:3.539em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7079em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathbf">x</span></span><span style="top:-3.0134em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathbf">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathbf">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.939em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>​F<sub>k</sub> 称为状态转移矩阵，表明如何从当前状态推算到下一个状态</p><p>​B<sub>k</sub> 称为状态控制矩阵，表明加速减速如何改变小车的状态</p><p>​u<sub>k</sub> 称为状态控制向量，表明控制的力度大小和方向</p><ul><li><p><strong>考虑系统外部影响</strong></p><p>由于外界有很多因素（比如风速，障碍物等）会对小车的状态产生影响。假设外部的不确定性因素对小车造成的系统状态误差服从高斯分布 <strong>w<sub>k</sub> ~ N(0, Q<sub>k</sub>)</strong>，我们就可以得到卡尔曼滤波中完整的状态预测方程：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtable rowspacing="0.25em" columnalign="right" columnspacing=""><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mover accent="true"><mi mathvariant="bold">x</mi><mo>^</mo></mover><mi>k</mi></msub><mo>=</mo><msub><mi mathvariant="bold">F</mi><mi>k</mi></msub><msub><mover accent="true"><mi mathvariant="bold">x</mi><mo>^</mo></mover><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi mathvariant="bold">B</mi><mi>k</mi></msub><msub><mi mathvariant="bold">u</mi><mi>k</mi></msub></mrow></mstyle></mtd></mtr></mtable><mo>+</mo><msub><mi>w</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\begin{aligned}\hat{\mathbf{x}}_{k}=\mathbf{F}_{k} \hat{\mathbf{x}}_{k-1}+\mathbf{B}_{k} \mathbf{u}_{k}\end{aligned} + w_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.5em;vertical-align:-0.5em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1em;"><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7079em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathbf">x</span></span><span style="top:-3.0134em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7079em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathbf">x</span></span><span style="top:-3.0134em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathbf">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathbf">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right" columnspacing=""><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mover accent="true"><mi mathvariant="bold">P</mi><mo>^</mo></mover><mi>k</mi></msub><mo>=</mo><msub><mi mathvariant="bold">F</mi><mi>k</mi></msub><msub><mi mathvariant="bold">P</mi><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msub><msubsup><mi mathvariant="bold">F</mi><mi>k</mi><mi>T</mi></msubsup><mo>+</mo><msub><mi mathvariant="bold">Q</mi><mi>k</mi></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}\hat{\mathbf{P}}_{k}=\mathbf{F}_{k} {\mathbf{P}}_{k-1} {\mathbf{F}}^T_{k}+\mathbf{Q}_{k}\end{aligned} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.6096em;vertical-align:-0.5548em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0548em;"><span style="top:-3.1052em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9495em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathbf">P</span></span><span style="top:-3.2551em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathbf">P</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathbf">F</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.453em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathbf">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5548em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>一般情况下，假设 w<sub>k</sub> 为 0。</p></li><li><p><strong>基于观测值进行最优估计</strong></p><p>在上述中，我们可以通过小车的上一个状态，对当前状态做出预测；但与此同时，我们也需要考虑小车的观测状态。</p><p>例如下图中，x<sub>k-1</sub>是小车前一个时刻的估计值，服从高斯分布，其中方差（variance）可以作为不确定性。</p><p><img src="/img/kalman/image-20250109120834141.png" alt="图2"></p><p>x<sub>k</sub>是<strong>下一个时刻的估计</strong>，可以看到——分布变“胖”了。显然下一个时刻的估计相比于前一个时刻的估计会更加的不准确（因为上一时刻本身就是估计值，根据估计值估计下一时刻，相当于在递推的过程中又加了一层噪声，显然误差会越来越大）。</p><p>y<sub>k</sub>是一个<strong>观测值</strong>，是传感器定位的结果，但传感器对小车距离的测量也会受到种种因素的影响，所以这个结果同样不准确。</p><p>现在，我们知道了下一个时刻的估计结果，也知道了传感器返回的观测值结果。那么问题就来了，到底应该相信谁？</p><p>科学家们做出了一个解释，<strong>用x<sub>k</sub>分布乘上y<sub>k</sub>的分布，会得到一个更加精确的位置的分布</strong>（实际上这就是卡尔曼滤波器需要做的事情）</p></li></ul><p><img src="/img/kalman/image-20250109122741224.png" alt="图3"></p><p>可以看到，新的分布不仅保证了在给定的蓝色和红色条件下，小车位于该点的概率最大。并且还是一个正态分布，这意味着可以把它当做初值继续往下算了！这就是Kalman滤波能够<strong>迭代</strong>的关键！</p><p>接下来，把灰色分布当做第一张图中的蓝色分布对k+1时刻进行预测，算法就可以开始循环往复了</p><ul><li><p><strong>实际中的计算方法</strong></p><p>在实际使用卡尔曼滤波的时候，计算的步骤一般为：</p><ol><li><p>预测阶段：使用模型来预测下一个时间点的状态和协方差</p><p><strong>a. 通过状态转移矩阵和控制输入预测下一个时间步的状态。</strong></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mi mathvariant="bold">x</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo stretchy="false">(</mo><mi mathvariant="bold">F</mi><mo>⋅</mo><mi mathvariant="bold">x</mi><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mi mathvariant="bold">B</mi><mo>⋅</mo><mi mathvariant="bold">u</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}\mathbf{x} &amp;= (\mathbf{F} \cdot \mathbf{x}) + (\mathbf{B} \cdot \mathbf{u}) \\\end{align*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.5em;vertical-align:-0.5em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1em;"><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathbf">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1em;"><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord mathbf">F</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathbf">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord mathbf">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathbf">u</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><ul><li><p><code>x</code> 是当前的状态向量（位置、速度等）。</p></li><li><p><code>F</code> 是状态转移矩阵，它描述了如何从当前状态推算到下一个状态。</p></li><li><p><code>Bu</code> 是控制输入项，其中 <code>B</code> 是控制输入矩阵，<code>u</code> 是控制输入向量。例如，在某些应用中，控制输入可能是加速度、外部力等。</p></li></ul><p><strong>b. 通过状态转移矩阵和过程噪声来预测下一个时间步的协方差。</strong></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mi mathvariant="bold">P</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mo stretchy="false">(</mo><mi mathvariant="bold">F</mi><mo>⋅</mo><mi mathvariant="bold">P</mi><mo>⋅</mo><msup><mi mathvariant="bold">F</mi><mi mathvariant="normal">⊤</mi></msup><mo stretchy="false">)</mo><mo>+</mo><mi mathvariant="bold">Q</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}\mathbf{P} &amp;= (\mathbf{F} \cdot \mathbf{P} \cdot \mathbf{F}^\top) + \mathbf{Q}\end{align*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.5591em;vertical-align:-0.5296em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0296em;"><span style="top:-3.1304em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathbf">P</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5296em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0296em;"><span style="top:-3.1304em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mopen">(</span><span class="mord mathbf">F</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathbf">P</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathbf">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathbf">Q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5296em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><ul><li><p><code>P</code> 是协方差矩阵，表示状态的不确定性。</p></li><li><p><code>F</code> 是状态转移矩阵，<code>P</code> 是当前的协方差矩阵。</p></li><li><p><code>Q</code> 是过程噪声协方差矩阵，表示系统本身的模型误差或噪声。</p></li></ul></li><li><p>更新阶段：通过新的测量值来调整预测的状态。</p><p><strong>a. 通过卡尔曼增益公式计算增益 <code>K</code>，它决定了如何将预测结果和测量值结合。</strong></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mi mathvariant="bold">K</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi mathvariant="bold">P</mi><mo>⋅</mo><msup><mi mathvariant="bold">H</mi><mi mathvariant="normal">⊤</mi></msup><mo>⋅</mo><msup><mrow><mo fence="true">(</mo><mrow><mo fence="true">(</mo><mi mathvariant="bold">H</mi><mo>⋅</mo><mi mathvariant="bold">P</mi><mo>⋅</mo><msup><mi mathvariant="bold">H</mi><mi mathvariant="normal">⊤</mi></msup><mo fence="true">)</mo></mrow><mo>+</mo><mi mathvariant="bold">R</mi><mo fence="true">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}\mathbf{K} &amp;= \mathbf{P} \cdot \mathbf{H}^\top \cdot \left( \left( \mathbf{H} \cdot \mathbf{P} \cdot \mathbf{H}^\top \right) + \mathbf{R} \right)^{-1} \\\end{align*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.7631em;vertical-align:-0.6316em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1316em;"><span style="top:-3.1316em;"><span class="pstrut" style="height:3.1031em;"></span><span class="mord"><span class="mord mathbf">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.6316em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1316em;"><span style="top:-3.1316em;"><span class="pstrut" style="height:3.1031em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathbf">P</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathbf">H</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord mathbf">H</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathbf">P</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathbf">H</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">⊤</span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathbf">R</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.1031em;"><span style="top:-3.352em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.6316em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><ul><li><p><code>K</code>是 <strong>卡尔曼增益</strong>，它表示我们对新测量值的信任程度。</p></li><li><p><code>P</code> 是预测的协方差矩阵。</p></li><li><p><code>H</code> 是观测矩阵，它将状态空间映射到测量空间。</p></li><li><p><code>R</code> 是测量噪声协方差矩阵，表示测量值的不确定性。</p></li></ul><p><strong>b. 计算当前测量值和预测测量值之间的差异</strong></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mi mathvariant="bold">y</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi mathvariant="bold">z</mi><mo>−</mo><mi mathvariant="bold">H</mi><mo>⋅</mo><mi mathvariant="bold">x</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}\mathbf{y} &amp;= \mathbf{z} -  \mathbf{H} \cdot \mathbf{x} \\\end{align*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.5em;vertical-align:-0.5em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1em;"><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1em;"><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathbf">z</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathbf">H</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathbf">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><ul><li><code>y</code> 是 <strong>创新</strong>（或者称为测量残差），表示测量值 <code>z</code> 与预测值 <code>Hx</code> 之间的差异。</li><li><code>z</code> 是实际的测量值。</li><li><code>Hx</code> 是根据当前预测状态 <code>x</code> 计算的测量值。</li></ul><p><strong>c. 通过将创新值 <code>y</code> 和卡尔曼增益 <code>K</code> 结合来更新预测的状态，目的是修正状态估计，使其更加接近实际的测量值。</strong></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mi mathvariant="bold">x</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi mathvariant="bold">x</mi><mo>+</mo><mi mathvariant="bold">K</mi><mo>⋅</mo><mi mathvariant="bold">y</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}\mathbf{x} &amp;= \mathbf{x} + \mathbf{K} \cdot \mathbf{y} \\\end{align*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.5em;vertical-align:-0.5em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1em;"><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathbf">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1em;"><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathbf">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathbf">K</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><ul><li><code>x</code> 是更新后的状态向量。</li><li><code>K</code> 是卡尔曼增益，<code>y</code> 是创新。</li></ul><p><strong>d. 更新协方差矩阵</strong></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mi mathvariant="bold">P</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mrow><mo fence="true">(</mo><mi mathvariant="bold">I</mi><mo>−</mo><mrow><mo fence="true">(</mo><mi mathvariant="bold">K</mi><mo>⋅</mo><mi mathvariant="bold">H</mi><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow><mo>⋅</mo><mi mathvariant="bold">P</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}\mathbf{P} &amp;= \left( \mathbf{I} - \left( \mathbf{K} \cdot \mathbf{H} \right) \right) \cdot \mathbf{P}\end{align*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.5em;vertical-align:-0.5em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1em;"><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathbf">P</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1em;"><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathbf">I</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathbf">K</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathbf">H</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathbf">P</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><ul><li><p><code>P</code> 是更新后的协方差矩阵。</p></li><li><p><code>I</code> 是单位矩阵。</p></li><li><p><code>(I - KH)</code> 是卡尔曼增益对协方差的修正因子。这个操作是用来减小更新后的协方差，表示我们对更新后的状态估计更有信心。</p></li></ul><p><strong>e. 计算创新协方差，用于后续的卡尔曼增益计算</strong></p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>S</mi><mo>=</mo><mi>H</mi><mi>P</mi><msup><mi>H</mi><mi>T</mi></msup><mo>+</mo><mi>R</mi></mrow><annotation encoding="application/x-tex">S = H P H^T + R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9747em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span></span></p><ul><li><p><code>S</code> 是创新协方差，</p></li><li><p><code>H</code> 是观测矩阵，</p></li><li><p><code>P</code> 是预测的协方差矩阵，</p></li><li><p><code>R</code> 是测量噪声协方差矩阵。</p></li></ul></li></ol><p>简单来说就是通过不断的预测和更新，使得卡尔曼滤波器能够精确地估计目标的状态，并且在实际应用中适应测量噪声和系统噪声的变化。</p><p><strong>注意：</strong></p><ol><li>时刻关注不断迭代的系统变量，分别是<strong>系统的状态x，误差协方差矩阵P，卡尔曼增益K</strong></li><li>在实际使用时，对Q和R的选择要依据实际情况，可以不断调试来试图寻找一个最优解。</li></ol></li></ul><h2 id="三、代码实践">三、代码实践</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> matplotlib <span class="hljs-keyword">import</span> pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">import</span> seaborn <span class="hljs-keyword">as</span> sns<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">from</span> filterpy.kalman <span class="hljs-keyword">import</span> KalmanFilter<br><br><span class="hljs-comment"># 生成1000个位置，从1到1000，是小车的实际位置</span><br>z = np.linspace(<span class="hljs-number">1</span>,<span class="hljs-number">1000</span>,<span class="hljs-number">1000</span>)<br><span class="hljs-comment"># 添加噪声</span><br>mu,sigma = <span class="hljs-number">0</span>,<span class="hljs-number">1</span><br>noise = np.random.normal(mu,sigma,<span class="hljs-number">1000</span>)<br><span class="hljs-comment"># 小车位置的观测值</span><br>z_nosie = z+noise<br><br><span class="hljs-comment"># dim_x 状态向量size,在该例中为[p,v]，即位置和速度,size=2</span><br><span class="hljs-comment"># dim_z 测量向量size，假设小车为匀速，速度为1，测量向量只观测位置，size=1</span><br>my_filter = KalmanFilter(dim_x=<span class="hljs-number">2</span>, dim_z=<span class="hljs-number">1</span>)<br><br><span class="hljs-comment"># 定义卡尔曼滤波中所需的参数</span><br><span class="hljs-comment"># x 初始状态为[0,0],即初始位置为0，速度为0.</span><br><span class="hljs-comment"># 这个初始值不是非常重要，在利用观测值进行更新迭代后会接近于真实值</span><br>my_filter.x = np.array([[<span class="hljs-number">0.</span>], [<span class="hljs-number">0.</span>]])<br><br><span class="hljs-comment"># p 协方差矩阵，表示状态向量内位置与速度的相关性</span><br><span class="hljs-comment"># 假设速度与位置没关系，协方差矩阵为[[1,0],[0,1]]</span><br>my_filter.P = np.array([[<span class="hljs-number">1.</span>, <span class="hljs-number">0.</span>], [<span class="hljs-number">0.</span>, <span class="hljs-number">1.</span>]])<br><br><span class="hljs-comment"># F 初始的状态转移矩阵，假设为匀速运动模型，可将其设为如下所示</span><br>my_filter.F = np.array([[<span class="hljs-number">1.</span>, <span class="hljs-number">1.</span>], [<span class="hljs-number">0.</span>, <span class="hljs-number">1.</span>]])<br><br><span class="hljs-comment"># Q 状态转移协方差矩阵，也就是外界噪声，</span><br><span class="hljs-comment"># 在该例中假设小车匀速，外界干扰小，所以我们对F非常确定，觉得F一定不会出错，所以Q设的很小</span><br>my_filter.Q = np.array([[<span class="hljs-number">0.0001</span>, <span class="hljs-number">0.</span>], [<span class="hljs-number">0.</span>, <span class="hljs-number">0.0001</span>]])<br><br><span class="hljs-comment"># 观测矩阵 Hx = p</span><br><span class="hljs-comment"># 利用观测数据对预测进行更新，观测矩阵的左边一项不能设置成0</span><br>my_filter.H = np.array([[<span class="hljs-number">1</span>, <span class="hljs-number">0</span>]])<br><span class="hljs-comment"># R 测量噪声，方差为1</span><br>my_filter.R = <span class="hljs-number">1</span><br><br><span class="hljs-comment"># 保存卡尔曼滤波过程中的位置和速度</span><br>z_new_list = []<br>v_new_list = []<br><span class="hljs-comment"># 对于每一个观测值，进行一次卡尔曼滤波</span><br><span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(z_nosie)):<br>    <span class="hljs-comment"># 预测过程</span><br>    my_filter.predict()<br>    <span class="hljs-comment"># 利用观测值进行更新</span><br>    my_filter.update(z_nosie[k])<br>    <span class="hljs-comment"># do something with the output</span><br>    x = my_filter.x<br>    <span class="hljs-comment"># 收集卡尔曼滤波后的速度和位置信息</span><br>    z_new_list.append(x[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>])<br>    v_new_list.append(x[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>])<br><br><span class="hljs-comment"># 位移的偏差</span><br>dif_list = []<br><span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(z)):<br>    dif_list.append(z_new_list[k]-z[k])<br><span class="hljs-comment"># 速度的偏差</span><br>v_dif_list = []<br><span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(z)):<br>    v_dif_list.append(v_new_list[k]-<span class="hljs-number">1</span>)<br>plt.figure(figsize=(<span class="hljs-number">20</span>,<span class="hljs-number">9</span>))<br>plt.subplot(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)<br>plt.xlim(-<span class="hljs-number">50</span>,<span class="hljs-number">1050</span>)<br>plt.ylim(-<span class="hljs-number">3.0</span>,<span class="hljs-number">3.0</span>)<br>plt.scatter(<span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(z)),dif_list,color =<span class="hljs-string">&#x27;b&#x27;</span>,label = <span class="hljs-string">&quot;位置偏差&quot;</span>)<br>plt.scatter(<span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(z)),v_dif_list,color =<span class="hljs-string">&#x27;y&#x27;</span>,label = <span class="hljs-string">&quot;速度偏差&quot;</span>)<br>plt.legend(loc = <span class="hljs-string">&#x27;upper right&#x27;</span>)<br>plt.show()<br></code></pre></td></tr></table></figure><p><strong>结果演示：</strong></p><p><img src="/img/kalman/image-20250109140421419.png" alt="图4"></p><h2 id="参考文献">参考文献</h2><p><a href="http://www.bzarg.com/p/how-a-kalman-filter-works-in-pictures/">http://www.bzarg.com/p/how-a-kalman-filter-works-in-pictures/</a></p><p><a href="https://blog.csdn.net/m0_46339652/article/details/119221972">https://blog.csdn.net/m0_46339652/article/details/119221972</a></p>]]></content>
    
    
    <categories>
      
      <category>DeepLearning</category>
      
    </categories>
    
    
    <tags>
      
      <tag>DeepLearning</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
